package wlow03_datastruct_algorithm.algorithm;

/*
* äºŒåˆ†æŸ¥æ‰¾åŠå…¶å„ç§ä¼˜åŒ–
* - æ—¶é—´å¤æ‚åº¦: O(log(n))
* - ç©ºé—´å¤æ‚åº¦: O(1)
* */
public class _0_0_BinarySearch {
    public static void main(String[] args) {
        int[] arr = {1, 2, 4, 7, 9, 11, 17, 23, 50, 68, 89, 102};
        int[] arrDuplicated = {1, 2, 4, 7, 9, 9, 9, 11, 17, 23, 50, 68, 68, 68, 89, 102};

        System.out.println("binarySearchBasic: " + binarySearchBasic(arr, 51));

        System.out.println("binarySearchLeftMost1: " + binarySearchLeftMost1(arrDuplicated, 5));
        System.out.println("binarySearchRightMost1: " + binarySearchRightMost1(arrDuplicated, 5));

        /*
        * ä¸€äº›åº”ç”¨åœºæ™¯:
        *      nå­˜åœ¨äºæ•°ç»„ä¸­æ—¶, ç”¨ä¸€èˆ¬çš„è¾¹ç•ŒæŸ¥æ‰¾(æ‰¾ä¸åˆ°æ—¶è¿”å›-1)å³å¯; nä¸å­˜åœ¨æ—¶, ä½¿ç”¨å¸¦åç¼€1çš„æ–¹æ³•
        *   - æ±‚ä¸€ä¸ªæ•°nåœ¨æœ‰åºæ•°ç»„ä¸­çš„æ’å(ä»å°åˆ°å¤§, ğŸ“Œç´¢å¼•ä»1å¼€å§‹) ==> leftmost(n) + 1
        *   -- ä»¥ä¸‹åº”ç”¨éƒ½æ˜¯é»˜è®¤æ•°ç»„çš„ç´¢å¼•ä»0å¼€å§‹:
        *   - æ±‚nçš„å·¦é‚»å±…(å‰ä»») ==> leftmost(n) - 1
        *   - æ±‚nçš„å³é‚»å±…(åä»») ==> rightmost(n) + 1
        *   - æ±‚nçš„è¿‘é‚» ==> å·¦é‚»å±…å’Œå³é‚»å±…ä¸­ä¸nç»å¯¹å€¼ä¹‹å·®è¾ƒå°è€…
        *   - æ±‚æ•°ç»„ä¸­å¤§äºxå°äºyçš„ç´¢å¼•èŒƒå›´ ==> [rightmost(x) + 1, leftmost(y) - 1]
        * */
    }

    /**
     * äºŒåˆ†æŸ¥æ‰¾åŸºæœ¬ç‰ˆ <p>
     *   1. è®¾ç½®ä¸¤ä¸ªæŒ‡é’ˆi = 0, j = n - 1 <p>
     *   2. å¦‚æœi > j, è¯´æ˜æ²¡æ‰¾åˆ°, ç»“æŸæŸ¥æ‰¾, è¿”å›-1 <p>
     *   3. ä»¤m = floor((i + j) / 2) <p>
     *   4. å¦‚æœarr[m] > n, ä»¤j = m - 1, å¹¶è·³åˆ°ç¬¬2æ­¥ <p>
     *   5. å¦‚æœarr[m] < n, ä»¤i = m + 1, å¹¶è·³åˆ°ç¬¬2æ­¥ <p>
     *   6. å¦‚æœarr[m] = n, è¯´æ˜æ‰¾åˆ°äº†, ç»“æŸæŸ¥æ‰¾, è¿”å›m <p>
     *
     * Java.utils.Arraysä¸­çš„äºŒåˆ†æŸ¥æ‰¾ä¹Ÿæ˜¯ä½¿ç”¨çš„åŸºæœ¬ç‰ˆ, åªä¸è¿‡æŸ¥æ‰¾å¤±è´¥æ—¶è¿”å›-(i + 1): {@link java.util.Arrays#binarySearch(int[], int)} <p>
     * - ğŸ“ŒæŸ¥æ‰¾å¤±è´¥æ—¶, içš„å€¼æ¯”è¾ƒç‰¹æ®Š. å¦‚æœè¦å°†næ’å…¥arrä¸­å¹¶ä¿æŒæœ‰åº, åˆ™è¦æ’å…¥çš„ç´¢å¼•ä½ç½®å°±æ˜¯æŸ¥æ‰¾å¤±è´¥æ—¶içš„å€¼. <p>
     * - æ‰€ä»¥æŸ¥æ‰¾å¤±è´¥æ—¶å¯ä»¥è¿”å› -i, ä½†æ˜¯è¦è·Ÿ -0 åŒºåˆ†å¼€æ¥, äºæ˜¯è¿”å› -(i + 1)
     * - å¦‚æœä¸å…³å¿ƒæ˜¯å¦æ‰¾åˆ°, åªéœ€è¦æ’å…¥å…ƒç´ çš„è¯, ç›´æ¥è¿”å›iå³å¯
     * @param arr æ•°ç»„ arr(0 : n-1), ğŸ“Œå·²æœ‰åº
     * @param n è¦æŸ¥æ‰¾çš„æ•°n
     * @return nå¯¹åº”çš„ç´¢å¼•. ä¸å­˜åœ¨æ—¶è¿”å›-1
     */
    public static int binarySearchBasic(int[] arr, int n) {
        int i = 0, j = arr.length - 1, m;
        // i = jæ—¶, m = i = jä¹Ÿè¿˜è¦å†è·Ÿnæ¯”è¾ƒä¸€ä¸‹ => i, jæ‰€æŒ‡å‘çš„å…ƒç´ ä¹Ÿä¼šå‚ä¸æ¯”è¾ƒ
        while(i <= j) {
            // ğŸ“Œè¿™é‡Œç”¨æ— ç¬¦å·å³ç§»ä¸€ä½è€Œä¸æ˜¯ / 2, é˜²æ­¢i, jè¿‡å¤§(> 2^31-1)å¯¼è‡´è¿ç®—æº¢å‡º
            // >> æ˜¯ç®—æœ¯(æœ‰ç¬¦å·)ç§»ä½, >>> æ˜¯é€»è¾‘(æ— ç¬¦å·)ç§»ä½
            // ğŸ“Œå½“i + jè¶…å‡ºäº†2^31-1(intæ­£æ•°ä¸Šé™), åœ¨åº•å±‚32ä½äºŒè¿›åˆ¶ä»£ç ä¸­é¦–ä½ç¬¦å·ä½å°±ä¼šæº¢å‡ºå˜æˆ1, Javaå°†å…¶å½“åšä¸€ä¸ªè´Ÿæ•°. ä½†æ­¤æ—¶è‹¥å°†å…¶çœ‹åšæ— ç¬¦å·æ•´æ•°, å°±æ˜¯æ­£ç¡®çš„ç»“æœ, æ‰€ä»¥é‡‡å–æ— ç¬¦å·å³ç§»çš„æ–¹å¼æ¥é™¤ä»¥2
            m = (i + j) >>> 1;
            if (n < arr[m]) {
                j = m - 1;
            } else if (arr[m] < n) {
                i = m + 1;
            } else {
                return m;
            }
        }
        return -1;
    }

    /**
     * binarySearchBasicçš„å·¦é—­å³å¼€åŒºé—´ç‰ˆæœ¬ <p>
     *  - ä¸Šé¢çš„binarySearchBasicä¸­çš„æŒ‡é’ˆi, jæŒ‡å‘çš„éƒ½æ˜¯éœ€è¦å‚ä¸æ¯”è¾ƒçš„å…ƒç´ , æ•…ä¸º'å·¦å³é—­åŒºé—´' <p>
     *  - è€Œåœ¨æ­¤å¤„, iä»ç„¶æŒ‡å‘éœ€è¦æ¯”è¾ƒçš„å…ƒç´ , ä½†jæŒ‡å‘çš„æ˜¯ä¸éœ€è¦å‚ä¸æ¯”è¾ƒçš„å…ƒç´ , æ˜¯'å·¦é—­å³å¼€åŒºé—´' <p>
     *  - æ‰€ä»¥è¦æ˜ç¡®æŒ‡é’ˆi, jçš„å«ä¹‰, æ‰èƒ½æ›´å¥½åœ°é€»è¾‘è¯æ˜
     *  - ğŸ“Œäºæ˜¯å¾ªç¯æ¡ä»¶å˜æˆäº†i < j, å› ä¸ºå½“i = jçš„æ—¶å€™æ˜¾ç„¶â†‘ä¸Šè¿°æ¡ä»¶â†‘ä¸æˆç«‹, åº”å½“ç»“æŸæŸ¥æ‰¾äº† <p>
     *  - å¹¶ä¸”mçš„å€¼ç›´æ¥èµ‹ç»™j, å› ä¸ºæ¯”è¾ƒè¿‡çš„å…ƒç´ åœ¨ä¸‹ä¸€è½®ä¸éœ€è¦æ¯”è¾ƒäº† <p>
     */
    public static int binarySearchBasic1(int[] arr, int n) {
        int i = 0, j = arr.length, m;
        while(i < j) {
            m = (i + j) >>> 1;
            if (n < arr[m]) {
                j = m;
            } else if (arr[m] < n) {
                i = m + 1;
            } else {
                return m;
            }
        }
        return -1;
    }

    /**
     * äºŒåˆ†æŸ¥æ‰¾çš„å¹³è¡¡ç‰ˆ. <p>
     *  - ä¸Šé¢çš„äºŒåˆ†æŸ¥æ‰¾åœ¨æŸ¥æ‰¾æ•°ç»„æœ€å·¦ä¾§å…ƒç´ å’Œæœ€å³ä¾§å…ƒç´ æ—¶æ¯”è¾ƒæ¬¡æ•°ä¸å¹³è¡¡: <p>
     *  -- ğŸ“ŒæŸ¥æ‰¾æœ€å·¦ä¾§å…ƒç´ æ—¶åªéœ€æ¯”è¾ƒn < arr[m], è€ŒæŸ¥æ‰¾æœ€å³ä¾§å…ƒç´ æ—¶è¿˜éœ€å†æ¯”è¾ƒarr[m] < n, æ¯”è¾ƒæ¬¡æ•°ç¿»å€äº† <p>
     *  - é€šè¿‡å°†ç›¸ç­‰çš„æ¯”è¾ƒç§»åˆ°å¾ªç¯å¤–ä¾§æ¥å¹³è¡¡æŸ¥æ‰¾æ¬¡æ•°. <p>
     *  - ä½†æ˜¯æ­¤æ—¶ç®—æ³•æœ€å¥½æƒ…å†µä¸‹çš„å¤æ‚åº¦ä¼šå¢ä¸ºO(log(n)), äºæ˜¯ç®—æ³•çš„å¤æ‚åº¦å¯è®°ä¸ºÎ˜(log(n)) <p>
     */
    public static int binarySearchBalanced(int[] arr, int n) {
        // å·¦é—­å³å¼€åŒºé—´: iæŒ‡å‘æŸ¥æ‰¾ç›®æ ‡, jæŒ‡å‘çš„ä¸æ˜¯æŸ¥æ‰¾ç›®æ ‡
        int i = 0, j = arr.length, m;
        while (j - i > 1) {
            m = (i + j) >>> 1;
            if (n < arr[m]) {
                j = m;
            } else {
                i = m;
            }
        }
        // å°†ç›¸ç­‰çš„æ¯”è¾ƒç§»åˆ°å¾ªç¯å¤–ä¾§ä»¥å¹³è¡¡æŸ¥æ‰¾æ¬¡æ•°
        return arr[i] == n ? i : -1;
    }

    /**
     *  äºŒåˆ†æŸ¥æ‰¾: æŸ¥æ‰¾é‡å¤å…ƒç´ æ—¶, è¿”å›å…¶ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•
     *   - æœªæ‰¾åˆ°æ—¶è¿”å›-1
     */
    public static int binarySearchLeftMost(int[] arr, int n) {
        int i = 0, j = arr.length - 1, m;
        int firstIndex = -1; // é‡å¤å€¼ç¬¬ä¸€æ¬¡å‡ºç°çš„å¯èƒ½ç´¢å¼•ä½ç½®
        while (i <= j) {
            m = (i + j) >>> 1;
            if (n < arr[m]) {
                j = m - 1;
            } else if (n > arr[m]) {
                i = m + 1;
            } else {
                firstIndex = m;
                // è¿™ä¸€æ­¥å¤„ç†è·Ÿn < arr[m]åˆ†æ”¯ä¸€æ ·, ä¹Ÿå°±æ˜¯å°†arr[m]è§†ä½œå¤§äºn, æ®æ­¤æ‰èƒ½æ‰¾åˆ°nå‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®
                j = m - 1; // è¿™é‡Œè¦æ±‚æ•°ç»„å¿…é¡»å‡åºæ’åˆ—
            }
        }
        return firstIndex;
    }

    /**
     *  äºŒåˆ†æŸ¥æ‰¾: æŸ¥æ‰¾é‡å¤å…ƒç´ æ—¶, è¿”å›å…¶æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼• <p>
     *   - æœªæ‰¾åˆ°æ—¶è¿”å›-1
     *  ä»£ç è·Ÿ {{@link #binarySearchLeftMost(int[], int)}} å¯¹ç§°
     */
    public static int binarySearchRightMost(int[] arr, int n) {
        int i = 0, j = arr.length - 1, m;
        int lastIndex = -1;
        while (i <= j) {
            m = (i + j) >>> 1;
            if (n > arr[m]) {
                i = m + 1;
            } else if (n < arr[m]) {
                j = m - 1;
            } else {
                lastIndex = m;
                i = m + 1;
            }
        }
        return lastIndex;
    }


    /**
     *  äºŒåˆ†æŸ¥æ‰¾ {{@link #binarySearchLeftMost(int[], int)}} çš„æ”¹ç‰ˆ: <br>
     *   - å…¶å®å°±æ˜¯åœ¨å…¶åŸºç¡€ä¸Šåˆ å»firstIndexå˜é‡, åˆå¹¶ifåˆ†æ”¯å¾—æ¥ <br>
     *   - æŸ¥æ‰¾é‡å¤å…ƒç´ æ—¶, è¿”å›å…¶ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•å€¼. æ²¡æ‰¾åˆ°æ—¶è¿”å›çš„æ˜¯>=nçš„æœ€å°(æœ€é å·¦)æ•°å­—ç´¢å¼• (æ’å…¥ä½ç½®) <br>
     *   - ğŸ“Œæ— æ³•åˆ¤æ–­æŸ¥æ‰¾æ˜¯å¦æˆåŠŸ, é€‚åˆä»…éœ€å¾€æ•°ç»„ä¸­æœ‰åºæ’å…¥å…ƒç´ æ—¶ä½¿ç”¨ (åœ¨è¿”å›å€¼å¯¹åº”çš„ç´¢å¼•ä¹‹å‰æ’å…¥)
     */
    public static int binarySearchLeftMost1(int[] arr, int n) {
        int i = 0, j = arr.length - 1, m;
        while (i <= j) {
            m = (i + j) >>> 1;
            if (n <= arr[m]) {
                j = m - 1;
            } else {
                i = m + 1;
            }
        }
        // ç›´æ¥return i, æ‰€ä»¥æ— æ³•åˆ¤æ–­æ˜¯å¦æŸ¥æ‰¾åˆ°å¯¹åº”å…ƒç´ 
        return i;
    }

    /**
     * åŒç†, äºŒåˆ†æŸ¥æ‰¾ {{@link #binarySearchRightMost(int[], int)}} çš„æ”¹ç‰ˆ. <br>
     *   - æŸ¥æ‰¾é‡å¤å…ƒç´ æ—¶, è¿”å›å…¶ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•å€¼. æ²¡æ‰¾åˆ°æ—¶è¿”å›çš„æ˜¯<=nçš„æœ€å¤§(æœ€é å³)æ•°å­—çš„ç´¢å¼• (æ’å…¥ä½ç½®) <br>
     *   - ğŸ“Œæ— æ³•åˆ¤æ–­æŸ¥æ‰¾æ˜¯å¦æˆåŠŸ, é€‚åˆä»…éœ€å¾€æ•°ç»„ä¸­æœ‰åºæ’å…¥å…ƒç´ æ—¶ä½¿ç”¨ (åœ¨è¿”å›å€¼å¯¹åº”çš„ç´¢å¼•ä¹‹åæ’å…¥)
     */
    public static int binarySearchRightMost1(int[] arr, int n) {
        int i = 0, j = arr.length - 1, m;
        while (i <= j) {
            m = (i + j) >>> 1;
            if (n < arr[m]) {
                j = m - 1;
            } else {
                i = m + 1;
            }
        }
        return j;
    }


    /**
     * leftmostå’Œrightmostçš„ç»“åˆç‰ˆæœ¬. ä¼ å…¥å‚æ•°lowerå†³å®šä½¿ç”¨å“ªç§
     *  - lower = true -> leftmost; false -> rightmost
     *  -- lowerä¸ºtrueæ—¶è·Ÿ {@link #binarySearchLeftMost(int[], int)} åŸºæœ¬ä¸€æ ·, åªæ˜¯index = mè¿™ä¸€æ­¥ä¼šå¤šæ‰§è¡Œå‡ æ¬¡
     *  -- lowerä¸ºfalseæ—¶ä¸ {@link #binarySearchRightMost(int[], int)} æœ‰åŒºåˆ«, åŒºåˆ«å°±æ˜¯indexæ˜¯ä»å³å¾€å·¦é€¼è¿‘ç›®æ ‡çš„.
     */
    public int binarySearchLR(int[] arr, int n, boolean lower) {
        int i = 0, j = arr.length - 1, m;
        int index = arr.length;
        while (i <= j) {
            m = (i + j) / 2;
            if (arr[m] > n || (lower && arr[m] >= n)) {
                j = m - 1;
                index = m;
            } else {
                i = m + 1;
            }
        }
        return index;
    }
}
