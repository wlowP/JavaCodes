package wlow03_datastruct_algorithm.algorithm.w2_0_Recursion;

import java.util.Arrays;

/**
 * <h2>é€’å½’06 - æ–æ³¢é‚£å¥‘æ•°åˆ—</h2>
 * é€’å½’æ±‚é€šé¡¹, æ—¶é—´å¤æ‚åº¦ä¸º Î¸(1.618^n) è¾¾åˆ°äº†æŒ‡æ•°çº§, å› æ­¤ä¸å¤ªå®ç”¨<br>
 * è€Œå¸¦å¤‡å¿˜æœºåˆ¶çš„æ–¹æ³•å¤æ‚åº¦é™åˆ°äº† O(n) <br>
 *
 * æœ‰è¯¸å¤šé—®é¢˜å…¶å®éƒ½æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—é—®é¢˜çš„ä¸åŒå®ä¾‹ <br>
 *  - æ¯”å¦‚å…”å­ç”Ÿå…”å­é—®é¢˜, ä»¥åŠçˆ¬æ¥¼æ¢¯é—®é¢˜
 */
public class R06_Fibonacci {
    public static void main(String[] args) {
        // [0, 1, 1, 2, 3, 5, 8, 13, 21, 34, ...]
        long start = System.currentTimeMillis();
        System.out.println(fibonacci(40));
        System.out.println("recursive: " + (System.currentTimeMillis() - start));
        start = System.currentTimeMillis();
        System.out.println(fibonacciMemo(40));
        System.out.println("recursive-memo: " + (System.currentTimeMillis() - start));
        start = System.currentTimeMillis();
        System.out.println(fibonacci1(40));
        System.out.println("non-recursive-memo: " + (System.currentTimeMillis() - start));
    }

     /**
     * <h3>é€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹ (ç´¢å¼•ä»0å¼€å§‹, ç¬¬0é¡¹è®¤ä¸ºæ˜¯0)</h3>
     * é€’æ¨å…³ç³»:
     * <pre><code>
     *     f(n) = 0                     n = 0,
     *            1                     n = 1,
     *            f(n - 1) + f(n - 2)   n > 1;
     * </code></pre>
     * <h3>ğŸ“Œå¤šè·¯é€’å½’</h3>
     * åœ¨æ­¤é€’å½’ä¸­, æ¯ä¸ªé€’å½’å‡½æ•°ä¾‹åŒ…å«å¤šæ¬¡è‡ªèº«è°ƒç”¨, è¿™å±äº<b>å¤šè·¯é€’å½’</b> <br>
     * <b>ç›¸å½“äºå°†é—®é¢˜æ‹†åˆ†æˆäº†å¤šä¸ªå­é—®é¢˜</b>, è€Œä¸æ˜¯å•è·¯é€’å½’é‚£æ ·ä¸€æ¬¡æ¬¡å‡å°é—®é¢˜çš„æ•°æ®è§„æ¨¡
     * å¤šè·¯é€’å½’çš„å…·ä½“æ‰§è¡Œè¿‡ç¨‹å¯ä»¥ç”»æˆæ ‘ç»“æ„æ¥ç›´è§‚ä½“ç°: <br>
     * <b>nè·¯é€’å½’ => nå‰æ ‘</b>
     * <pre><code>
     *     // ä»¥f(4)ä¸ºä¾‹.
     *     f(4)
     *       -- f(3)
     *         -- f(2)
     *           -- f(1)
     *           -- f(0)
     *         -- f(1)
     *       -- f(2)
     *         -- f(1)
     *         -- f(0)
     * </code></pre>
     * ç”±æ­¤è¿˜èƒ½å¾—å‡ºé€’å½’è°ƒç”¨æ¬¡æ•°ä¸æ–æ³¢é‚£å¥‘æ•°åˆ—çš„è§„å¾‹: <br>
     *  - å‡½æ•°è°ƒç”¨æ¬¡æ•°ç­‰äºæ ‘çš„èŠ‚ç‚¹ä¸ªæ•°, ä¹Ÿç­‰äº <pre>2 * f(n + 1) - 1</pre>
     *  - å†ç”±æ–æ³¢é‚£å¥‘æ•°åˆ—çš„é€šé¡¹å…¬å¼, å¾—å‡ºæ—¶é—´å¤æ‚åº¦ä¸º <pre><b>Î¸(1.618^n)</b></pre> è¾¾åˆ°äº†æŒ‡æ•°çº§å¤æ‚åº¦ <br>
     *  -- <b>å› ä¸ºæ—¶é—´å¤æ‚åº¦çš„å…·ä½“å…¬å¼å·²çŸ¥, è€Œä¸æ˜¯å‡è®¾æœ€å/æœ€å¥½æƒ…å†µ</b>, æ‰€ä»¥ç›´æ¥è¡¨ç¤ºä¸ºÎ¸(...)
     * @param n è¦è·å–çš„é¡¹çš„ç´¢å¼•(ä»0å¼€å§‹)
     * @return ç¬¬né¡¹å¯¹åº”çš„å€¼
     */
    public static int fibonacci(int n) {
        if (n == 0) {
            return 0;
        } else if (n == 1) {
            return 1;
        }
        return fibonacci(n - 1) + fibonacci(n - 2);
    }

    /**
     * <h3>å¸¦å¤‡å¿˜æœºåˆ¶(è®°å¿†, Memoization)çš„é€’å½’ç‰ˆ</h3>
     * ä»é€’å½’æ ‘å¯çœ‹å‡º, é€’å½’ç‰ˆçš„æ–æ³¢é‚£å¥‘æ•°æ–¹æ³• {@link #fibonacci} ä¼šè¿›è¡Œå¤šæ¬¡é‡å¤è¿ç®— <br>
     *  - æ¯”å¦‚ä¸Šé¢f(4)çš„æ —å­ä¸­f(2)å°±è®¡ç®—äº†ä¸¤é <br>
     * æ­¤æ—¶å¯ä»¥è®¾ç«‹å˜é‡æ¥å­˜å‚¨ä¹‹å‰çš„è¿ç®—ç»“æœ, ç„¶åç›´æ¥ä½¿ç”¨. -- å¤‡å¿˜æœºåˆ¶ <br>
     * æ­¤æŠ€æ³•ä¹Ÿç§°ä¸ºä»¥ç©ºé—´æ¢æ—¶é—´ <br><br>
     *
     * æ­¤å¤„è®¾ç«‹ä¸€ä¸ªé•¿åº¦ä¸ºnçš„æ•°ç»„, ç”¨æ¥è®°å½•è®¡ç®—å‡ºçš„æ–æ³¢é‚£å¥‘æ•°ç»„ä¸­çš„æ¯ä¸€é¡¹ <br>
     * è¿™æ ·ä»¥å, åœ¨é€’å½’æ—¶å¦‚æœå‘ç°æ•°ç»„ä¸­å·²å­˜åœ¨è®¡ç®—ç»“æœ, ç›´æ¥æ‹¿æ¥ç”¨, è€Œä¸æ˜¯å†è®¡ç®—ä¸€æ¬¡ <br>
     * æ˜¾è‘—é™ä½äº†ç®—æ³•æ—¶é—´å¤æ‚åº¦:
     * <h4>Î¸(1.618^n) => O(n)</h4>
     * @param n è¦è·å–çš„é¡¹çš„ç´¢å¼•(ä»0å¼€å§‹)
     * @return ç¬¬né¡¹å¯¹åº”çš„å€¼
     */
    public static int fibonacciMemo(int n) {
        int[] fibonacci = new int[n + 1];
        // è¿˜æœªè®¡ç®—å‡ºæ¥çš„æ¯ä¸€é¡¹éƒ½è®¾ç½®ä¸º-1ä»¥ä¾¿é€’å½’æ—¶åˆ¤æ–­
        Arrays.fill(fibonacci, -1);
        fibonacci[0] = 0;
        fibonacci[1] = 1;
        return fm(n, fibonacci);
    }

    private static int fm(int n, int[] fibonacci) {
        /*if (n == 0) {
            return 0;
        } else if (n == 1) {
            return 1;
        }*/
        // æ¯æ¬¡é€’å½’ä¹‹å‰éƒ½å…ˆçœ‹çœ‹å¤‡å¿˜æ•°ç»„ä¸­æ˜¯å¦å·²å­˜åœ¨è®¡ç®—ç»“æœ, å¦‚æœæœ‰ç›´æ¥åå›ä¹‹
        if (fibonacci[n] != -1) {
            return fibonacci[n];
        }
        /*
        * int a = fm(n - 1, fibonacci);
        * int b = fm(n - 2, fibonacci);
        * fibonacci[n] = a + b;
        * return fibonacci[n];
        * ç®€å†™ä¸ºå¦‚ä¸‹å½¢å¼:
        * */
        return (fibonacci[n] = fm(n - 1, fibonacci) + fm(n - 2, fibonacci));
    }

    /**
     * <h3>å¸¦å¤‡å¿˜æœºåˆ¶(è®°å¿†, Memoization)çš„éé€’å½’ç‰ˆ</h3><br>

     * æ­¤å¤„è®¾ç«‹ä¸‰ä¸ªå˜é‡c, a, b, åˆ†åˆ«ä»£è¡¨æ–æ³¢é‚£å¥‘é€’æ¨å…¬å¼: f(n) = f(n - 1) + f(n - 2)ä¸­çš„ä¸‰é¡¹ <br>
     * æ¯è®¡ç®—å‡ºæ–°çš„ä¸€é¡¹, å³c = a + b, å°±å°†æ•°æ®æ•´ä½“å¾€å‰ç§»åŠ¨, aä¸­çš„æ•°æ®f(n - 1)èˆå¼ƒ, ç„¶åå¦‚æ­¤å¾ªç¯ç›´åˆ°ç®—å‡ºf(n)
     * @param n è¦è·å–çš„é¡¹çš„ç´¢å¼•(ä»0å¼€å§‹)
     * @return ç¬¬né¡¹å¯¹åº”çš„å€¼
     */
    public static int fibonacci1(int n) {
        if (n == 0) {
            return 0;
        } else if (n == 1) {
            return 1;
        } else {
            int a = 0, b = 1, c;
            for (int i = 0; i < n - 1; i++) {
                c = a + b;
                a = b;
                b = c;
            }
            return b;
        }
    }
}
